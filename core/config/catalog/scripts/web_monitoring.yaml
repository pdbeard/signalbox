# Web Monitoring Example Scripts
# These scripts are NOT meant for production use - they are educational tools!
# This file demonstrates web service monitoring capabilities using signalbox.
scripts:
  - name: check_website_health
    description: Check if main website is responding
    command: "URL=https://httpbin.org/status/200; if curl -f -s -o /dev/null $URL; then echo OK $URL; else echo DOWN $URL; fi"
    log_limit:
      type: count
      value: 5
    alerts:
      - pattern: "^OK "
        message: "Website is up."
        severity: info
      - pattern: "^DOWN "
        message: "Website is down!"
        severity: critical
  - name: check_api_response_time
    description: Measure API response time
    command: "URL=https://httpbin.org/delay/1; TIME=$(curl -o /dev/null -s -w '%{time_total}' $URL); echo RESPONSE $URL $TIME"
    log_limit:
      type: count
      value: 5
    alerts:
      - pattern: "^RESPONSE "
        message: "API response time measured."
        severity: info
  - name: check_ssl_certificate
    description: Check SSL certificate expiration
    command: "DOMAIN=httpbin.org; EXPIRY=$(echo | timeout 10 openssl s_client -servername $DOMAIN -connect $DOMAIN:443 2>/dev/null | openssl x509 -noout -enddate 2>/dev/null | cut -d= -f2); if [ -z \"$EXPIRY\" ]; then echo SSLFAIL $DOMAIN; else echo SSL $DOMAIN $EXPIRY; fi"
    log_limit:
      type: count
      value: 5
    alerts:
      - pattern: "^SSL "
        message: "SSL certificate expiry date found."
        severity: info
      - pattern: "^SSLFAIL "
        message: "SSL certificate check failed!"
        severity: warning
  - name: check_dns_resolution
    description: Test DNS resolution
    command: "DOMAIN=httpbin.org; if command -v dig >/dev/null 2>&1; then ADDR=$(dig +short $DOMAIN | head -n1); else ADDR=$(nslookup $DOMAIN 2>/dev/null | awk '/^Address: /{print $2; exit}'); fi; if [ -n \"$ADDR\" ]; then echo DNS $DOMAIN $ADDR; else echo DNSFAIL $DOMAIN; fi"
    log_limit:
      type: count
      value: 5
    alerts:
      - pattern: "^DNS "
        message: "DNS resolution succeeded."
        severity: info
      - pattern: "^DNSFAIL "
        message: "DNS resolution failed."
        severity: warning